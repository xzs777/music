{"remainingRequest":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\music-main\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\music-main\\src\\components\\search\\searchList.vue?vue&type=style&index=0&id=9fbeaa66&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\music-main\\src\\components\\search\\searchList.vue","mtime":1605180606980},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\music-main\\node_modules\\css-loader\\dist\\cjs.js","mtime":1605024328000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\music-main\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1605024328000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\music-main\\node_modules\\postcss-loader\\src\\index.js","mtime":1605024328000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\music-main\\node_modules\\less-loader\\dist\\cjs.js","mtime":1605024328000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\music-main\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1605024328000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\music-main\\node_modules\\vue-loader\\lib\\index.js","mtime":1605024328000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoubWFpbi1uYXYgewogIG92ZXJmbG93OiBoaWRkZW47Cn0KCi5tYWluLXNvbmctbGlzdCAubWFpbi1wYWdlIHsKICB3aWR0aDogMzUwcHg7CiAgbWFyZ2luOiAwIGF1dG87CiAgaGVpZ2h0OiA1MHB4OwogIHBhZGRpbmc6IDEwcHggMDsKICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogIG1hcmdpbi1ib3R0b206IDEwcHg7Cn0KCi5tYWluLXNvbmctdHQgewogIGhlaWdodDogODBweDsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIGJveC1zaGFkb3c6IDAgMCA0cHggcmdiYSgwLCAwLCAwLCAwLjI1KTsKICBtYXJnaW4tYm90dG9tOiA0cHg7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHBhZGRpbmc6IDIwcHg7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKCiAgc3BhbiB7CiAgICBmb250LXNpemU6IDIwcHg7CiAgfQoKICBpIHsKICAgIGZvbnQtc2l6ZTogMTNweDsKICAgIGZvbnQtc3R5bGU6IG5vcm1hbDsKICAgIG1hcmdpbi1sZWZ0OiAxMHB4OwogICAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC43NSk7CiAgfQp9CgoubWFpbi1zb25nLWxpc3QgewogIGhlaWdodDogNDIwcHg7CiAgb3ZlcmZsb3c6IHNjcm9sbDsKfQoKLnNlYXJjaC1ndWlkZSB7CiAgaGVpZ2h0OiA0OTRweDsKICB3aWR0aDogMzQwcHg7CiAgYmFja2dyb3VuZDogI2ZmZjsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgei1pbmRleDogOTk5OwogIHRvcDogNDBweDsKICByaWdodDogMDsKICBib3gtc2hhZG93OiAtNnB4IDZweCA2cHggcmdiYSgwLCAwLCAwLCAwLjI1KTsKCiAgLmd1aWRlLWJveCB7CiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgcGFkZGluZzogOHB4IDE1cHg7CiAgfQoKICAuZ3VpZGUtYm94LXR0IHsKICAgIGhlaWdodDogNDBweDsKICAgIGxpbmUtaGVpZ2h0OiA0MHB4OwogICAgZm9udC1zaXplOiAxNHB4OwogICAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC42KTsKICB9CgogIC5ob3QtdGFncyAuZWwtdGFnIHsKICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7CiAgICBwYWRkaW5nOiAwIDEycHg7CiAgICBoZWlnaHQ6IDI2cHg7CiAgICBsaW5lLWhlaWdodDogMjZweDsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIG1hcmdpbi1yaWdodDogMTBweDsKICAgIG1hcmdpbi1ib3R0b206IDhweDsKICB9CgogIC5ob3QtdGFncyAuZWwtdGFnOmhvdmVyIHsKICAgIGJhY2tncm91bmQ6ICNmMWYxZjE7CiAgfQoKICAubXVzaWMtaW1nLXRpdGxlIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKCiAgICAuZWwtaW1hZ2UgewogICAgICB3aWR0aDogNTBweDsKICAgICAgaGVpZ2h0OiA1MHB4OwogICAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICAgIG1hcmdpbi1yaWdodDogMTBweDsKICAgIH0KCiAgICBzcGFuIHsKICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgICB3aWR0aDogMTgwcHg7CiAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7CiAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwogICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgfQogIH0KfQo="},{"version":3,"sources":["searchList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+OA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"searchList.vue","sourceRoot":"src/components/search","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"main-header\">\r\n      <i class=\"el-icon-arrow-left\" @click=\"$router.push('../music')\"></i>\r\n      <div class=\"search\">\r\n        <input type=\"text\" class=\"input-search\" v-model=\"searchValueNew\" @keyup.enter=\"searchEvent\"\r\n          @focus=\"searchGuide\" />\r\n        <i class=\"el-icon-search\" @click=\"searchEvent\"></i>\r\n      </div>\r\n    </div>\r\n    <div class=\"search-guide\" v-show=\"searchOpenclose\">\r\n      <div class=\"guide-box\">\r\n        <!-- <div class=\"guide-box-tt\">热门搜索</div>\r\n        <div class=\"hot-tags\">\r\n          <el-tag\r\n            effect=\"plain\"\r\n            type=\"info\"\r\n            v-for=\"(item, i) in searchHots\"\r\n            :key=\"i\"\r\n            @click=\"hotTagEvent\"\r\n          >{{item.first}}</el-tag>\r\n        </div> -->\r\n        <div class=\"guide-box-tt\">历史搜索</div>\r\n        <div class=\"hot-tags\">\r\n          <el-tag effect=\"plain\" type=\"info\" v-for=\"(item, i) in historyTags\" :key=\"i\" @click=\"hotTagEvent\"\r\n            :closable=\"true\" @close=\"historyTagClose(item)\">{{item}}</el-tag>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"main-nav\">\r\n      <div class=\"main-song-tt\">\r\n        <span>{{searchValue}}</span>\r\n        <!-- <i>找到 {{total}} 首单曲</i> -->\r\n      </div>\r\n      <div class=\"main-song-list\">\r\n\r\n        <el-table :data=\"searchlist\" style=\"width: 100%;\" :stripe=\"true\" @row-click=\"getMusicUrl\" :show-header=\"false\">\r\n          <el-table-column type=\"index\" width=\"60px\"></el-table-column>\r\n          <el-table-column prop=\"\" label=\"封面\">\r\n            <template slot-scope=\"scoped\">\r\n              <div class=\"music-img-title\">\r\n                <el-image :src=\"require('@/store/covers/'+scoped.row.pic)\"\r\n                  style=\"width: 50px ; height: 50px;border-radius: 4px;margin-right: 10px;\">\r\n                  <div slot=\"placeholder\" class=\"image-slot\">\r\n                    <i class=\"el-icon-picture\" style=\"font-size:50px;color:#f1f1f1\"></i>\r\n                  </div>\r\n                </el-image>\r\n              </div>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"name\" label=\"歌曲名\">\r\n          </el-table-column>\r\n          <el-table-column prop=\"author\" label=\"歌手\" width=\"180\">\r\n          </el-table-column>\r\n          <el-table-column prop=\"album\" label=\"专辑\" width=\"180\"></el-table-column>\r\n          \r\n          <!-- 收藏歌曲按钮 -->\r\n          <el-table-column prop=\"\" label=\"收藏\" width=\"60px\">\r\n            <el-button type=\"danger\" icon=\"el-icon-star-off\" size=\"mini\" circle></el-button>\r\n          </el-table-column>\r\n        </el-table>\r\n\r\n        <div class=\"main-page\">\r\n          <el-pagination @current-change=\"handleCurrentChange\" :current-page=\"(searchQury.offset/searchQury.limit) + 1\"\r\n            :page-size=\"searchQury.limit\" layout=\"total, prev, pager, next\" :total=\"total\" background :small=\"true\">\r\n          </el-pagination>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        searchQury: {\r\n          offset: 0,\r\n          limit: 10,\r\n          type: 1\r\n        },\r\n        searchValue: '',\r\n        // total: 0,\r\n        searchValueNew: '',\r\n        searchlist: [],\r\n        searchOpenclose: false,\r\n        searchHots: [],\r\n        historyTags: []\r\n      }\r\n    },\r\n    methods: {\r\n\r\n      // 获取搜索列表,val--搜索关键词\r\n      async getSearchList(val) {\r\n\r\n        //api\r\n        this.$request.get(`/sfasdfearch?keywords=${val}`,\r\n          { params: this.searchQury }).then(res => {\r\n\r\n            const arrData = []\r\n            res.data.Musiclist.forEach(item => {\r\n              const arr = {}\r\n              arr.name = item.name//歌曲名\r\n              arr.author = item.artist//作者\r\n              arr.id = item.id//歌曲id\r\n              arr.album = item.album//专辑名\r\n              arr.pic = item.coverurl//封面地址\r\n              arr.src = item.src//歌曲地址\r\n              arrData.push(arr)\r\n            })\r\n            this.searchlist = arrData\r\n\r\n          }).catch(err => {\r\n\r\n\r\n            //测试数据\r\n            const arrData = []\r\n            const arr = {}\r\n            arr.name = 'name'\r\n            arr.author = 'author'\r\n            arr.id = '1'\r\n            arr.album = 'album'\r\n            arr.pic = 'cover1.jpg'\r\n            arr.src = 'music1.mp3'\r\n            arrData.push(arr)\r\n            this.searchlist = arrData\r\n            //测试数据\r\n\r\n            this.$message.error('未找到相应歌曲');\r\n          })\r\n\r\n\r\n\r\n        // const { data: res } = await this.$request.get(`/search?keywords=${val}`, {\r\n        //   params: this.searchQury\r\n        // })\r\n        // const arrData = []\r\n        // res.result.songs.forEach(item => {\r\n        //   const arr = {}\r\n        //   arr.name = item.name\r\n        //   arr.author = []\r\n        //   item.artists.forEach(i => {\r\n        //     arr.author.push(i.name)\r\n        //   })\r\n        //   arr.id = item.id\r\n        //   arr.album = item.album.name\r\n        //   arr.pic = item.artists[0].img1v1Url\r\n        //   // arr.time =\r\n        //   //   Math.floor((item.duration % 3600000) / 60000) > 10\r\n        //   //     ? Math.floor((item.duration % 3600000) / 60000)\r\n        //   //     : '0' + Math.floor((item.duration % 3600000) / 60000)\r\n        //   // arr.time +=\r\n        //   //   ':' +\r\n        //   //   (Math.floor((item.duration % 60000) / 1000) > 10\r\n        //   //     ? Math.floor((item.duration % 60000) / 1000)\r\n        //   //     : '0' + Math.floor((item.duration % 60000) / 1000))\r\n        //   arrData.push(arr)\r\n        // })\r\n        // this.searchlist = arrData\r\n        // // this.total = res.result.songCount\r\n\r\n      },\r\n      handleCurrentChange(pagenum) {\r\n        this.searchQury.offset = (pagenum - 1) * this.searchQury.limit\r\n        this.getSearchList(this.searchValue)\r\n      },\r\n\r\n\r\n\r\n      // 点击搜索到的音乐,播放\r\n      async getMusicUrl(obj) {\r\n        let music = {}\r\n        music = {\r\n          title: obj.name,\r\n          artist: obj.author,\r\n          pic: require('@/store/covers/' + obj.pic),   // cover1.jpg\r\n          src: require('@/store/musicfiles/' + obj.src),// music1.src\r\n          id: obj.id\r\n        }\r\n        window.sessionStorage.setItem('nowMusic', JSON.stringify(music))\r\n        this.$store.dispatch('dealAutoPlay', music)\r\n      },\r\n\r\n\r\n      // 搜索事件\r\n      searchEvent() {\r\n        window.sessionStorage.setItem('searchValue', this.searchValueNew)\r\n        this.searchValue = this.searchValueNew\r\n        this.getSearchList(this.searchValue)\r\n        const history = window.sessionStorage.getItem('searchHistory')\r\n        var arr = history === null ? [] : JSON.parse(history)\r\n        if (!arr.includes(this.searchValue.trim())) {\r\n          if (arr.length < 10) {\r\n            arr.unshift(this.searchValue.trim())\r\n          } else {\r\n            arr.splice(9, 1)\r\n            arr.unshift(this.searchValue.trim())\r\n          }\r\n        }\r\n        window.sessionStorage.setItem('searchHistory', JSON.stringify(arr))\r\n        this.searchOpenclose = false\r\n      },\r\n      // 搜索向导框\r\n      async searchGuide(el) {\r\n        this.$store.state.controlMsc.showList = false\r\n        const { data: res } = await this.$request.get('/search/hot')\r\n        this.searchHots = res.result.hots\r\n        const history = window.sessionStorage.getItem('searchHistory')\r\n        var arr = history === null ? [] : JSON.parse(history)\r\n        this.historyTags = arr\r\n        this.searchOpenclose = true\r\n        const guideBox = document.querySelector('.search-guide')\r\n        window.onclick = e => {\r\n          if (!guideBox.contains(e.target) && !el.target.contains(e.target)) {\r\n            this.searchOpenclose = false\r\n            window.onclick = null\r\n          }\r\n        }\r\n      },\r\n      hotTagEvent(e) {\r\n        this.searchValueNew = e.target.innerText.trim()\r\n        this.searchEvent()\r\n      },\r\n      historyTagClose(tag) {\r\n        this.historyTags.splice(this.historyTags.indexOf(tag), 1)\r\n        window.sessionStorage.setItem(\r\n          'searchHistory',\r\n          JSON.stringify(this.historyTags)\r\n        )\r\n      }\r\n    },\r\n    created() {\r\n      const searchValue = window.sessionStorage.getItem('searchValue')\r\n      this.searchValue = searchValue.trim()\r\n      this.getSearchList(searchValue)\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"less\" scoped>\r\n  .main-nav {\r\n    overflow: hidden;\r\n  }\r\n\r\n  .main-song-list .main-page {\r\n    width: 350px;\r\n    margin: 0 auto;\r\n    height: 50px;\r\n    padding: 10px 0;\r\n    box-sizing: border-box;\r\n    margin-bottom: 10px;\r\n  }\r\n\r\n  .main-song-tt {\r\n    height: 80px;\r\n    background: #fff;\r\n    box-shadow: 0 0 4px rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 4px;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 20px;\r\n    box-sizing: border-box;\r\n\r\n    span {\r\n      font-size: 20px;\r\n    }\r\n\r\n    i {\r\n      font-size: 13px;\r\n      font-style: normal;\r\n      margin-left: 10px;\r\n      color: rgba(0, 0, 0, 0.75);\r\n    }\r\n  }\r\n\r\n  .main-song-list {\r\n    height: 420px;\r\n    overflow: scroll;\r\n  }\r\n\r\n  .search-guide {\r\n    height: 494px;\r\n    width: 340px;\r\n    background: #fff;\r\n    position: absolute;\r\n    z-index: 999;\r\n    top: 40px;\r\n    right: 0;\r\n    box-shadow: -6px 6px 6px rgba(0, 0, 0, 0.25);\r\n\r\n    .guide-box {\r\n      box-sizing: border-box;\r\n      padding: 8px 15px;\r\n    }\r\n\r\n    .guide-box-tt {\r\n      height: 40px;\r\n      line-height: 40px;\r\n      font-size: 14px;\r\n      color: rgba(0, 0, 0, 0.6);\r\n    }\r\n\r\n    .hot-tags .el-tag {\r\n      border-radius: 15px;\r\n      padding: 0 12px;\r\n      height: 26px;\r\n      line-height: 26px;\r\n      cursor: pointer;\r\n      margin-right: 10px;\r\n      margin-bottom: 8px;\r\n    }\r\n\r\n    .hot-tags .el-tag:hover {\r\n      background: #f1f1f1;\r\n    }\r\n\r\n    .music-img-title {\r\n      display: flex;\r\n      align-items: center;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n      overflow: hidden;\r\n\r\n      .el-image {\r\n        width: 50px;\r\n        height: 50px;\r\n        border-radius: 4px;\r\n        margin-right: 10px;\r\n      }\r\n\r\n      span {\r\n        display: inline-block;\r\n        width: 180px;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n        overflow: hidden;\r\n      }\r\n    }\r\n  }\r\n</style>"]}]}
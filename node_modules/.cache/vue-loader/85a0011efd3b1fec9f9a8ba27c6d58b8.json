{"remainingRequest":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\src\\components\\search\\searchList.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\src\\components\\search\\searchList.vue","mtime":1604995848855},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VhcmNoUXVyeTogewogICAgICAgIG9mZnNldDogMCwKICAgICAgICBsaW1pdDogMTAsCiAgICAgICAgdHlwZTogMQogICAgICB9LAogICAgICBzZWFyY2hWYWx1ZTogJycsCiAgICAgIHRvdGFsOiAwLAogICAgICBzZWFyY2hWYWx1ZU5ldzogJycsCiAgICAgIHNlYXJjaGxpc3Q6IFtdLAogICAgICBzZWFyY2hPcGVuY2xvc2U6IGZhbHNlLAogICAgICBzZWFyY2hIb3RzOiBbXSwKICAgICAgaGlzdG9yeVRhZ3M6IFtdCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDojrflj5bmkJzntKLliJfooagKICAgIGFzeW5jIGdldFNlYXJjaExpc3QodmFsKSB7CiAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRyZXF1ZXN0LmdldChgL3NlYXJjaD9rZXl3b3Jkcz0ke3ZhbH1gLCB7CiAgICAgICAgcGFyYW1zOiB0aGlzLnNlYXJjaFF1cnkKICAgICAgfSkKICAgICAgY29uc3QgYXJyRGF0YSA9IFtdCiAgICAgIHJlcy5yZXN1bHQuc29uZ3MuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICBjb25zdCBhcnIgPSB7fQogICAgICAgIGFyci5uYW1lID0gaXRlbS5uYW1lCiAgICAgICAgYXJyLmF1dGhvciA9IFtdCiAgICAgICAgaXRlbS5hcnRpc3RzLmZvckVhY2goaSA9PiB7CiAgICAgICAgICBhcnIuYXV0aG9yLnB1c2goaS5uYW1lKQogICAgICAgIH0pCiAgICAgICAgYXJyLmlkID0gaXRlbS5pZAogICAgICAgIGFyci5hbGJ1bSA9IGl0ZW0uYWxidW0ubmFtZQogICAgICAgIGFyci5waWMgPSBpdGVtLmFydGlzdHNbMF0uaW1nMXYxVXJsCiAgICAgICAgYXJyLnRpbWUgPQogICAgICAgICAgTWF0aC5mbG9vcigoaXRlbS5kdXJhdGlvbiAlIDM2MDAwMDApIC8gNjAwMDApID4gMTAKICAgICAgICAgICAgPyBNYXRoLmZsb29yKChpdGVtLmR1cmF0aW9uICUgMzYwMDAwMCkgLyA2MDAwMCkKICAgICAgICAgICAgOiAnMCcgKyBNYXRoLmZsb29yKChpdGVtLmR1cmF0aW9uICUgMzYwMDAwMCkgLyA2MDAwMCkKICAgICAgICBhcnIudGltZSArPQogICAgICAgICAgJzonICsKICAgICAgICAgIChNYXRoLmZsb29yKChpdGVtLmR1cmF0aW9uICUgNjAwMDApIC8gMTAwMCkgPiAxMAogICAgICAgICAgICA/IE1hdGguZmxvb3IoKGl0ZW0uZHVyYXRpb24gJSA2MDAwMCkgLyAxMDAwKQogICAgICAgICAgICA6ICcwJyArIE1hdGguZmxvb3IoKGl0ZW0uZHVyYXRpb24gJSA2MDAwMCkgLyAxMDAwKSkKICAgICAgICBhcnJEYXRhLnB1c2goYXJyKQogICAgICB9KQogICAgICB0aGlzLnNlYXJjaGxpc3QgPSBhcnJEYXRhCiAgICAgIHRoaXMudG90YWwgPSByZXMucmVzdWx0LnNvbmdDb3VudAogICAgfSwKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UocGFnZW51bSkgewogICAgICB0aGlzLnNlYXJjaFF1cnkub2Zmc2V0ID0gKHBhZ2VudW0gLSAxKSAqIHRoaXMuc2VhcmNoUXVyeS5saW1pdAogICAgICB0aGlzLmdldFNlYXJjaExpc3QodGhpcy5zZWFyY2hWYWx1ZSkKICAgIH0sCiAgICAvLyDojrflj5bpn7PkuZDmkq3mlL7lnLDlnYAKICAgIGFzeW5jIGdldE11c2ljVXJsKG9iaikgewogICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kcmVxdWVzdC5nZXQoYC9zb25nL3VybD9pZD0ke29iai5pZH1gKQogICAgICBsZXQgbXVzaWMgPSB7fQogICAgICBtdXNpYyA9IHsKICAgICAgICB0aXRsZTogb2JqLm5hbWUsCiAgICAgICAgYXJ0aXN0OiBvYmouYXV0aG9yLmpvaW4oJyAnKSwKICAgICAgICBzcmM6IHJlcy5kYXRhWzBdLnVybCwKICAgICAgICBwaWM6IG9iai5waWMsCiAgICAgICAgaWQ6IG9iai5pZAogICAgICB9CiAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdub3dNdXNpYycsIEpTT04uc3RyaW5naWZ5KG11c2ljKSkKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2RlYWxBdXRvUGxheScsIG11c2ljKQogICAgfSwKICAgIC8vIOaQnOe0ouS6i+S7tgogICAgc2VhcmNoRXZlbnQoKSB7CiAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdzZWFyY2hWYWx1ZScsIHRoaXMuc2VhcmNoVmFsdWVOZXcpCiAgICAgIHRoaXMuc2VhcmNoVmFsdWUgPSB0aGlzLnNlYXJjaFZhbHVlTmV3CiAgICAgIHRoaXMuZ2V0U2VhcmNoTGlzdCh0aGlzLnNlYXJjaFZhbHVlKQogICAgICBjb25zdCBoaXN0b3J5ID0gd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3NlYXJjaEhpc3RvcnknKQogICAgICB2YXIgYXJyID0gaGlzdG9yeSA9PT0gbnVsbCA/IFtdIDogSlNPTi5wYXJzZShoaXN0b3J5KQogICAgICBpZiAoIWFyci5pbmNsdWRlcyh0aGlzLnNlYXJjaFZhbHVlLnRyaW0oKSkpIHsKICAgICAgICBpZiAoYXJyLmxlbmd0aCA8IDEwKSB7CiAgICAgICAgICBhcnIudW5zaGlmdCh0aGlzLnNlYXJjaFZhbHVlLnRyaW0oKSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXJyLnNwbGljZSg5LCAxKQogICAgICAgICAgYXJyLnVuc2hpZnQodGhpcy5zZWFyY2hWYWx1ZS50cmltKCkpCiAgICAgICAgfQogICAgICB9CiAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdzZWFyY2hIaXN0b3J5JywgSlNPTi5zdHJpbmdpZnkoYXJyKSkKICAgICAgdGhpcy5zZWFyY2hPcGVuY2xvc2UgPSBmYWxzZQogICAgfSwKICAgIC8vIOaQnOe0ouWQkeWvvOahhgogICAgYXN5bmMgc2VhcmNoR3VpZGUoZWwpIHsKICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuY29udHJvbE1zYy5zaG93TGlzdCA9IGZhbHNlCiAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRyZXF1ZXN0LmdldCgnL3NlYXJjaC9ob3QnKQogICAgICB0aGlzLnNlYXJjaEhvdHMgPSByZXMucmVzdWx0LmhvdHMKICAgICAgY29uc3QgaGlzdG9yeSA9IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdzZWFyY2hIaXN0b3J5JykKICAgICAgdmFyIGFyciA9IGhpc3RvcnkgPT09IG51bGwgPyBbXSA6IEpTT04ucGFyc2UoaGlzdG9yeSkKICAgICAgdGhpcy5oaXN0b3J5VGFncyA9IGFycgogICAgICB0aGlzLnNlYXJjaE9wZW5jbG9zZSA9IHRydWUKICAgICAgY29uc3QgZ3VpZGVCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoLWd1aWRlJykKICAgICAgd2luZG93Lm9uY2xpY2sgPSBlID0+IHsKICAgICAgICBpZiAoIWd1aWRlQm94LmNvbnRhaW5zKGUudGFyZ2V0KSAmJiAhZWwudGFyZ2V0LmNvbnRhaW5zKGUudGFyZ2V0KSkgewogICAgICAgICAgdGhpcy5zZWFyY2hPcGVuY2xvc2UgPSBmYWxzZQogICAgICAgICAgd2luZG93Lm9uY2xpY2sgPSBudWxsCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgaG90VGFnRXZlbnQoZSkgewogICAgICB0aGlzLnNlYXJjaFZhbHVlTmV3ID0gZS50YXJnZXQuaW5uZXJUZXh0LnRyaW0oKQogICAgICB0aGlzLnNlYXJjaEV2ZW50KCkKICAgIH0sCiAgICBoaXN0b3J5VGFnQ2xvc2UodGFnKSB7CiAgICAgIHRoaXMuaGlzdG9yeVRhZ3Muc3BsaWNlKHRoaXMuaGlzdG9yeVRhZ3MuaW5kZXhPZih0YWcpLCAxKQogICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgKICAgICAgICAnc2VhcmNoSGlzdG9yeScsCiAgICAgICAgSlNPTi5zdHJpbmdpZnkodGhpcy5oaXN0b3J5VGFncykKICAgICAgKQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGNvbnN0IHNlYXJjaFZhbHVlID0gd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3NlYXJjaFZhbHVlJykKICAgIHRoaXMuc2VhcmNoVmFsdWUgPSBzZWFyY2hWYWx1ZS50cmltKCkKICAgIHRoaXMuZ2V0U2VhcmNoTGlzdChzZWFyY2hWYWx1ZSkKICB9Cn0K"},{"version":3,"sources":["searchList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"searchList.vue","sourceRoot":"src/components/search","sourcesContent":["<template>\n  <div>\n    <div class=\"main-header\">\n      <i class=\"el-icon-arrow-left\" @click=\"$router.push('../music')\"></i>\n      <div class=\"search\">\n        <input\n          type=\"text\"\n          class=\"input-search\"\n          v-model=\"searchValueNew\"\n          @keyup.enter=\"searchEvent\"\n          @focus=\"searchGuide\"\n        />\n        <i class=\"el-icon-search\" @click=\"searchEvent\"></i>\n      </div>\n    </div>\n    <div class=\"search-guide\" v-show=\"searchOpenclose\">\n      <div class=\"guide-box\">\n        <div class=\"guide-box-tt\">热门搜索</div>\n        <div class=\"hot-tags\">\n          <el-tag\n            effect=\"plain\"\n            type=\"info\"\n            v-for=\"(item, i) in searchHots\"\n            :key=\"i\"\n            @click=\"hotTagEvent\"\n          >{{item.first}}</el-tag>\n        </div>\n        <div class=\"guide-box-tt\">历史搜索</div>\n        <div class=\"hot-tags\">\n          <el-tag\n            effect=\"plain\"\n            type=\"info\"\n            v-for=\"(item, i) in historyTags\"\n            :key=\"i\"\n            @click=\"hotTagEvent\"\n            :closable=\"true\"\n            @close=\"historyTagClose(item)\"\n          >{{item}}</el-tag>\n        </div>\n      </div>\n    </div>\n    <div class=\"main-nav\">\n      <div class=\"main-song-tt\">\n        <span>{{searchValue}}</span>\n        <i>找到 {{total}} 首单曲</i>\n      </div>\n      <div class=\"main-song-list\">\n        <el-table :data=\"searchlist\" style=\"width: 100%\" :stripe=\"true\" @row-click=\"getMusicUrl\">\n          <el-table-column type=\"index\" width=\"60px\"></el-table-column>\n          <el-table-column prop=\"name\" label=\"音乐标题\"></el-table-column>\n          <el-table-column prop=\"author\" label=\"歌手\" width=\"180\">\n            <template slot-scope=\"scope\">\n              <span v-for=\"(item,i) in scope.row.author\" :key=\"i\">{{item + ' '}}</span>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"album\" label=\"专辑\" width=\"180\"></el-table-column>\n          <el-table-column prop=\"time\" label=\"时长\" width=\"100\"></el-table-column>\n        </el-table>\n        <div class=\"main-page\">\n          <el-pagination\n            @current-change=\"handleCurrentChange\"\n            :current-page=\"(searchQury.offset/searchQury.limit) + 1\"\n            :page-size=\"searchQury.limit\"\n            layout=\"total, prev, pager, next\"\n            :total=\"total\"\n            background\n            :small=\"true\"\n          ></el-pagination>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      searchQury: {\n        offset: 0,\n        limit: 10,\n        type: 1\n      },\n      searchValue: '',\n      total: 0,\n      searchValueNew: '',\n      searchlist: [],\n      searchOpenclose: false,\n      searchHots: [],\n      historyTags: []\n    }\n  },\n  methods: {\n    // 获取搜索列表\n    async getSearchList(val) {\n      const { data: res } = await this.$request.get(`/search?keywords=${val}`, {\n        params: this.searchQury\n      })\n      const arrData = []\n      res.result.songs.forEach(item => {\n        const arr = {}\n        arr.name = item.name\n        arr.author = []\n        item.artists.forEach(i => {\n          arr.author.push(i.name)\n        })\n        arr.id = item.id\n        arr.album = item.album.name\n        arr.pic = item.artists[0].img1v1Url\n        arr.time =\n          Math.floor((item.duration % 3600000) / 60000) > 10\n            ? Math.floor((item.duration % 3600000) / 60000)\n            : '0' + Math.floor((item.duration % 3600000) / 60000)\n        arr.time +=\n          ':' +\n          (Math.floor((item.duration % 60000) / 1000) > 10\n            ? Math.floor((item.duration % 60000) / 1000)\n            : '0' + Math.floor((item.duration % 60000) / 1000))\n        arrData.push(arr)\n      })\n      this.searchlist = arrData\n      this.total = res.result.songCount\n    },\n    handleCurrentChange(pagenum) {\n      this.searchQury.offset = (pagenum - 1) * this.searchQury.limit\n      this.getSearchList(this.searchValue)\n    },\n    // 获取音乐播放地址\n    async getMusicUrl(obj) {\n      const { data: res } = await this.$request.get(`/song/url?id=${obj.id}`)\n      let music = {}\n      music = {\n        title: obj.name,\n        artist: obj.author.join(' '),\n        src: res.data[0].url,\n        pic: obj.pic,\n        id: obj.id\n      }\n      window.sessionStorage.setItem('nowMusic', JSON.stringify(music))\n      this.$store.dispatch('dealAutoPlay', music)\n    },\n    // 搜索事件\n    searchEvent() {\n      window.sessionStorage.setItem('searchValue', this.searchValueNew)\n      this.searchValue = this.searchValueNew\n      this.getSearchList(this.searchValue)\n      const history = window.sessionStorage.getItem('searchHistory')\n      var arr = history === null ? [] : JSON.parse(history)\n      if (!arr.includes(this.searchValue.trim())) {\n        if (arr.length < 10) {\n          arr.unshift(this.searchValue.trim())\n        } else {\n          arr.splice(9, 1)\n          arr.unshift(this.searchValue.trim())\n        }\n      }\n      window.sessionStorage.setItem('searchHistory', JSON.stringify(arr))\n      this.searchOpenclose = false\n    },\n    // 搜索向导框\n    async searchGuide(el) {\n      this.$store.state.controlMsc.showList = false\n      const { data: res } = await this.$request.get('/search/hot')\n      this.searchHots = res.result.hots\n      const history = window.sessionStorage.getItem('searchHistory')\n      var arr = history === null ? [] : JSON.parse(history)\n      this.historyTags = arr\n      this.searchOpenclose = true\n      const guideBox = document.querySelector('.search-guide')\n      window.onclick = e => {\n        if (!guideBox.contains(e.target) && !el.target.contains(e.target)) {\n          this.searchOpenclose = false\n          window.onclick = null\n        }\n      }\n    },\n    hotTagEvent(e) {\n      this.searchValueNew = e.target.innerText.trim()\n      this.searchEvent()\n    },\n    historyTagClose(tag) {\n      this.historyTags.splice(this.historyTags.indexOf(tag), 1)\n      window.sessionStorage.setItem(\n        'searchHistory',\n        JSON.stringify(this.historyTags)\n      )\n    }\n  },\n  created() {\n    const searchValue = window.sessionStorage.getItem('searchValue')\n    this.searchValue = searchValue.trim()\n    this.getSearchList(searchValue)\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.main-nav {\n  overflow: hidden;\n}\n.main-song-list .main-page {\n  width: 350px;\n  margin: 0 auto;\n  height: 50px;\n  padding: 10px 0;\n  box-sizing: border-box;\n  margin-bottom: 10px;\n}\n.main-song-tt {\n  height: 80px;\n  background: #fff;\n  box-shadow: 0 0 4px rgba(0, 0, 0, 0.25);\n  margin-bottom: 4px;\n  display: flex;\n  align-items: center;\n  padding: 20px;\n  box-sizing: border-box;\n  span {\n    font-size: 20px;\n  }\n  i {\n    font-size: 13px;\n    font-style: normal;\n    margin-left: 10px;\n    color: rgba(0, 0, 0, 0.75);\n  }\n}\n.main-song-list {\n  height: 420px;\n  overflow: scroll;\n}\n.search-guide {\n  height: 494px;\n  width: 340px;\n  background: #fff;\n  position: absolute;\n  z-index: 999;\n  top: 40px;\n  right: 0;\n  box-shadow: -6px 6px 6px rgba(0, 0, 0, 0.25);\n  .guide-box {\n    box-sizing: border-box;\n    padding: 8px 15px;\n  }\n  .guide-box-tt {\n    height: 40px;\n    line-height: 40px;\n    font-size: 14px;\n    color: rgba(0, 0, 0, 0.6);\n  }\n  .hot-tags .el-tag {\n    border-radius: 15px;\n    padding: 0 12px;\n    height: 26px;\n    line-height: 26px;\n    cursor: pointer;\n    margin-right: 10px;\n    margin-bottom: 8px;\n  }\n  .hot-tags .el-tag:hover {\n    background: #f1f1f1;\n  }\n}\n</style>\n"]}]}
{"remainingRequest":"C:\\Users\\74031\\Desktop\\新建文件夹 (7)\\music-main\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\74031\\Desktop\\新建文件夹 (7)\\music-main\\src\\components\\newmusic\\Newmusic.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (7)\\music-main\\src\\components\\newmusic\\Newmusic.vue","mtime":1605181335102},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (7)\\music-main\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1605024328000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (7)\\music-main\\node_modules\\babel-loader\\lib\\index.js","mtime":1605024328000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (7)\\music-main\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1605024328000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (7)\\music-main\\node_modules\\vue-loader\\lib\\index.js","mtime":1605024328000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbGlzdEluZGV4OiAwLAogICAgICB0eXBlTGlzdDogWwogICAgICAgIHsgbmFtZTogJ+WFqOmDqCcsIHR5cGU6IDAgfSwKICAgICAgICAvLyB7IG5hbWU6ICfljY7or60nLCB0eXBlOiA3IH0sCiAgICAgICAgLy8geyBuYW1lOiAn5qyn576OJywgdHlwZTogOTYgfSwKICAgICAgICAvLyB7IG5hbWU6ICfml6XmnKwnLCB0eXBlOiA4IH0sCiAgICAgICAgLy8geyBuYW1lOiAn6Z+p5Zu9JywgdHlwZTogMTYgfQogICAgICBdLAogICAgICBtdXNpY2xpc3Q6IFtdLAogICAgICBtdXNpY2RhdGE6IFtdLAogICAgICBxdWVyeU51bTogMTAsCiAgICAgIHNjcm9sbFN0YXR1czogZmFsc2UKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGxpc3RjaGFuZ2UoaXRlbSkgewogICAgICB0aGlzLmxpc3RJbmRleCA9IGl0ZW0KICAgICAgdGhpcy5nZXRNdXNpY0xpc3QodGhpcy50eXBlTGlzdFtpdGVtXS50eXBlKQogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbi1zb25nLWxpc3QnKS5zY3JvbGxUbygwLCAwKQogICAgfSwKICAgIC8vIGFzeW5jIGdldE11c2ljTGlzdCgpIHsvL+iOt+W+l+mfs+S5kOWIl+ihqAogICAgLy8gICBjb25zdCB0eXBlID0gYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyAwIDogYXJndW1lbnRzWzBdCiAgICAvLyAgIC8vIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRyZXF1ZXN0LmdldChgL3RvcC9zb25nP3R5cGU9JHt0eXBlfWApCiAgICAvLyAgIGNvbnN0IGFyckRhdGEgPSBbXQogICAgLy8gICByZXMuZGF0YS5mb3JFYWNoKGl0ZW0gPT4gewogICAgLy8gICAgIGNvbnN0IGFyciA9IHt9CiAgICAvLyAgICAgYXJyLm5hbWUgPSBpdGVtLm5hbWUKICAgIC8vICAgICBhcnIucGljID0gaXRlbS5hbGJ1bS5waWNVcmwKICAgIC8vICAgICBhcnIuYXV0aG9yID0gW10KICAgIC8vICAgICBpdGVtLmFydGlzdHMuZm9yRWFjaChpID0+IHsKICAgIC8vICAgICAgIGFyci5hdXRob3IucHVzaChpLm5hbWUpCiAgICAvLyAgICAgfSkKICAgIC8vICAgICBhcnIuaWQgPSBpdGVtLmlkCiAgICAvLyAgICAgLy8gYXJyLnRpbWUgPQogICAgLy8gICAgIC8vICAgTWF0aC5mbG9vcigoaXRlbS5kdXJhdGlvbiAlIDM2MDAwMDApIC8gNjAwMDApID4gMTAKICAgIC8vICAgICAvLyAgICAgPyBNYXRoLmZsb29yKChpdGVtLmR1cmF0aW9uICUgMzYwMDAwMCkgLyA2MDAwMCkKICAgIC8vICAgICAvLyAgICAgOiAnMCcgKyBNYXRoLmZsb29yKChpdGVtLmR1cmF0aW9uICUgMzYwMDAwMCkgLyA2MDAwMCkKICAgIC8vICAgICAvLyBhcnIudGltZSArPQogICAgLy8gICAgIC8vICAgJzonICsKICAgIC8vICAgICAvLyAgIChNYXRoLmZsb29yKChpdGVtLmR1cmF0aW9uICUgNjAwMDApIC8gMTAwMCkgPiAxMAogICAgLy8gICAgIC8vICAgICA/IE1hdGguZmxvb3IoKGl0ZW0uZHVyYXRpb24gJSA2MDAwMCkgLyAxMDAwKQogICAgLy8gICAgIC8vICAgICA6ICcwJyArIE1hdGguZmxvb3IoKGl0ZW0uZHVyYXRpb24gJSA2MDAwMCkgLyAxMDAwKSkKICAgIC8vICAgICBhcnIuYWxidW0gPSBpdGVtLmFsYnVtLm5hbWUKICAgIC8vICAgICBhcnJEYXRhLnB1c2goYXJyKQogICAgLy8gICB9KQogICAgLy8gICB0aGlzLm11c2ljZGF0YSA9IGFyckRhdGEKICAgIC8vICAgdGhpcy5tdXNpY2xpc3QgPSB0aGlzLmdldEFycmF5RGF0YShhcnJEYXRhLCAxLCAxMCkKICAgIC8vIH0sCiAgICBhc3luYyBnZXRNdXNpY0xpc3QoKSB7Ly/ojrflvpfpn7PkuZDliJfooajmtYvor5XvvIznm67liY3lj6/mjqXmlLYKICAgICAgY29uc3QgeyBkYXRhOiByZXMgfSA9IGF3YWl0IHRoaXMuJHJlcXVlc3QuZ2V0KGAvdG9wL3Nvbmc/dHlwZT0ke3R5cGV9YCkKICAgICAgY29uc3QgYXJyRGF0YSA9IFtdCiAgICAgIHJlcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgY29uc3QgYXJyID0ge30KICAgICAgICBhcnIubmFtZSA9IGl0ZW0uTmFtZQogICAgICAgIGFyci5waWMgPSAncGljJwogICAgICAgIGFyci5hdXRob3IgPSBpdGVtLlNpbmdlcmlkCiAgICAgICAgYXJyLmlkID0gaXRlbS5JRAogICAgICAgIGFyci5hbGJ1bSA9IGl0ZW0uQWxidW1pZAogICAgICAgIGFyckRhdGEucHVzaChhcnIpCiAgICAgIH0pCiAgICAgIHRoaXMubXVzaWNkYXRhID0gYXJyRGF0YQogICAgICB0aGlzLm11c2ljbGlzdCA9IHRoaXMuZ2V0QXJyYXlEYXRhKGFyckRhdGEsIDEsIDEwKQogICAgfSwKICAgIC8vIOiOt+WPlumfs+S5kOaSreaUvuWcsOWdgAogICAgYXN5bmMgZ2V0TXVzaWNVcmwob2JqKSB7CiAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRyZXF1ZXN0LmdldChgL3NvbmcvdXJsP2lkPSR7b2JqLmlkfWApCiAgICAgIGxldCBtdXNpYyA9IHt9CiAgICAgIG11c2ljID0gewogICAgICAgIHRpdGxlOiBvYmoubmFtZSwKICAgICAgICBhcnRpc3Q6IG9iai5hdXRob3Iuam9pbignICcpLAogICAgICAgIHNyYzogcmVzLmRhdGFbMF0udXJsLAogICAgICAgIHBpYzogb2JqLnBpYywKICAgICAgICBpZDogb2JqLmlkCiAgICAgIH0KICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ25vd011c2ljJywgSlNPTi5zdHJpbmdpZnkobXVzaWMpKQogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZGVhbEF1dG9QbGF5JywgbXVzaWMpCiAgICB9LAogICAgLy8g5pWw57uE5o+Q5Y+W6YOo5YiG5pWw5o2uCiAgICBnZXRBcnJheURhdGEoZGF0YSwgc3RhcnQsIG51bSkgewogICAgICBjb25zdCByZXMgPSBbXQogICAgICBjb25zdCBsZW5ndGggPQogICAgICAgIHN0YXJ0ICsgbnVtIC0gMSA+IGRhdGEubGVuZ3RoID8gZGF0YS5sZW5ndGggOiBzdGFydCArIG51bSAtIDEKICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0IC0gMTsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgcmVzLnB1c2goZGF0YVtpXSkKICAgICAgfQogICAgICByZXR1cm4gcmVzCiAgICB9LAogICAgbGlzdGVuU2Nyb2xsKGUpIHsKICAgICAgY29uc3Qgc2Nyb2xsID0gKAogICAgICAgIGUudGFyZ2V0LnNjcm9sbFRvcCAvCiAgICAgICAgKGUudGFyZ2V0LnNjcm9sbEhlaWdodCAtIGUudGFyZ2V0LmNsaWVudEhlaWdodCkKICAgICAgKS50b0ZpeGVkKDMpCiAgICAgIGlmIChzY3JvbGwgPiAwLjk1ICYmICF0aGlzLnNjcm9sbFN0YXR1cykgewogICAgICAgIHRoaXMuc2Nyb2xsU3RhdHVzID0gdHJ1ZQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgaWYgKHRoaXMucXVlcnlOdW0gPCAxMDApIHsKICAgICAgICAgICAgdGhpcy5xdWVyeU51bSArPSAxMAogICAgICAgICAgICB0aGlzLm11c2ljbGlzdCA9IHRoaXMuZ2V0QXJyYXlEYXRhKHRoaXMubXVzaWNkYXRhLCAxLCB0aGlzLnF1ZXJ5TnVtKQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICBlLnRhcmdldC5zY3JvbGxUbygwLCAodGhpcy5xdWVyeU51bSAtIDEwKSAqIDc1IC0gZS50YXJnZXQuY2xpZW50SGVpZ2h0KQogICAgICAgICAgICAgIHRoaXMuc2Nyb2xsU3RhdHVzID0gZmFsc2UKICAgICAgICAgICAgfSwgMTApCiAgICAgICAgICB9CiAgICAgICAgfSwgMTUwMCkKICAgICAgfQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0TXVzaWNMaXN0KCkKICB9Cn0K"},{"version":3,"sources":["Newmusic.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Newmusic.vue","sourceRoot":"src/components/newmusic","sourcesContent":["<template>\n  <div>\n    <div class=\"new-list\">\n      <ul class=\"new-header-list\">\n        <li\n          v-for=\"(item,i) in typeList\"\n          :key=\"i\"\n          :class=\"listIndex === i ? 'select' : ''\"\n          @click=\"listchange(i)\"\n        >{{item.name}}</li>\n      </ul>\n      <el-button type=\"danger\" size=\"mini\" @click=\"playMusicAtonce(musiclist)\">立即播放</el-button>\n    </div>\n    <div\n      class=\"main-song-list\"\n      style=\"height:360px;overflow:hidden scroll;width:790px\"\n      @scroll=\"listenScroll\"\n    >\n      <el-table\n        :data=\"musiclist\"\n        style=\"width: 100%;\"\n        :stripe=\"true\"\n        @row-click=\"getMusicUrl\"\n        :show-header=\"false\"\n      >\n        <el-table-column type=\"index\" width=\"60px\"></el-table-column>\n        <el-table-column prop=\"name\" label=\"音乐标题\">\n          <template slot-scope=\"scoped\">\n            <div class=\"music-img-title\">\n              <el-image :src=\"scoped.row.pic\">\n                <div slot=\"placeholder\" class=\"image-slot\">\n                  <i class=\"el-icon-picture\" style=\"font-size:50px;color:#f1f1f1\"></i>\n                </div>\n              </el-image>\n              <span>{{scoped.row.name}}</span>\n            </div>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"author\" label=\"歌手\" width=\"180\">\n          <template slot-scope=\"scope\">\n            <span v-for=\"(item,i) in scope.row.author\" :key=\"i\">{{item + ' '}}</span>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"album\" label=\"专辑\" width=\"180\"></el-table-column>\n        <!-- <el-table-column prop=\"time\" label=\"时长\" width=\"100\"></el-table-column> -->\n      </el-table>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      listIndex: 0,\n      typeList: [\n        { name: '全部', type: 0 },\n        // { name: '华语', type: 7 },\n        // { name: '欧美', type: 96 },\n        // { name: '日本', type: 8 },\n        // { name: '韩国', type: 16 }\n      ],\n      musiclist: [],\n      musicdata: [],\n      queryNum: 10,\n      scrollStatus: false\n    }\n  },\n  methods: {\n    listchange(item) {\n      this.listIndex = item\n      this.getMusicList(this.typeList[item].type)\n      document.querySelector('.main-song-list').scrollTo(0, 0)\n    },\n    // async getMusicList() {//获得音乐列表\n    //   const type = arguments[0] === undefined ? 0 : arguments[0]\n    //   // const { data: res } = await this.$request.get(`/top/song?type=${type}`)\n    //   const arrData = []\n    //   res.data.forEach(item => {\n    //     const arr = {}\n    //     arr.name = item.name\n    //     arr.pic = item.album.picUrl\n    //     arr.author = []\n    //     item.artists.forEach(i => {\n    //       arr.author.push(i.name)\n    //     })\n    //     arr.id = item.id\n    //     // arr.time =\n    //     //   Math.floor((item.duration % 3600000) / 60000) > 10\n    //     //     ? Math.floor((item.duration % 3600000) / 60000)\n    //     //     : '0' + Math.floor((item.duration % 3600000) / 60000)\n    //     // arr.time +=\n    //     //   ':' +\n    //     //   (Math.floor((item.duration % 60000) / 1000) > 10\n    //     //     ? Math.floor((item.duration % 60000) / 1000)\n    //     //     : '0' + Math.floor((item.duration % 60000) / 1000))\n    //     arr.album = item.album.name\n    //     arrData.push(arr)\n    //   })\n    //   this.musicdata = arrData\n    //   this.musiclist = this.getArrayData(arrData, 1, 10)\n    // },\n    async getMusicList() {//获得音乐列表测试，目前可接收\n      const { data: res } = await this.$request.get(`/top/song?type=${type}`)\n      const arrData = []\n      res.data.forEach(item => {\n        const arr = {}\n        arr.name = item.Name\n        arr.pic = 'pic'\n        arr.author = item.Singerid\n        arr.id = item.ID\n        arr.album = item.Albumid\n        arrData.push(arr)\n      })\n      this.musicdata = arrData\n      this.musiclist = this.getArrayData(arrData, 1, 10)\n    },\n    // 获取音乐播放地址\n    async getMusicUrl(obj) {\n      const { data: res } = await this.$request.get(`/song/url?id=${obj.id}`)\n      let music = {}\n      music = {\n        title: obj.name,\n        artist: obj.author.join(' '),\n        src: res.data[0].url,\n        pic: obj.pic,\n        id: obj.id\n      }\n      window.sessionStorage.setItem('nowMusic', JSON.stringify(music))\n      this.$store.dispatch('dealAutoPlay', music)\n    },\n    // 数组提取部分数据\n    getArrayData(data, start, num) {\n      const res = []\n      const length =\n        start + num - 1 > data.length ? data.length : start + num - 1\n      for (var i = start - 1; i < length; i++) {\n        res.push(data[i])\n      }\n      return res\n    },\n    listenScroll(e) {\n      const scroll = (\n        e.target.scrollTop /\n        (e.target.scrollHeight - e.target.clientHeight)\n      ).toFixed(3)\n      if (scroll > 0.95 && !this.scrollStatus) {\n        this.scrollStatus = true\n        setTimeout(() => {\n          if (this.queryNum < 100) {\n            this.queryNum += 10\n            this.musiclist = this.getArrayData(this.musicdata, 1, this.queryNum)\n            setTimeout(() => {\n              e.target.scrollTo(0, (this.queryNum - 10) * 75 - e.target.clientHeight)\n              this.scrollStatus = false\n            }, 10)\n          }\n        }, 1500)\n      }\n    }\n  },\n  created() {\n    this.getMusicList()\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.music-img-title {\n  display: flex;\n  align-items: center;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  .el-image {\n    width: 50px;\n    height: 50px;\n    border-radius: 4px;\n    margin-right: 10px;\n  }\n  span {\n    display: inline-block;\n    width: 180px;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow: hidden;\n  }\n}\n.new-list {\n  position: relative;\n  height: 40px;\n  line-height: 40px;\n  .new-header-list {\n    display: block;\n    list-style-type: none;\n    .select {\n      font-weight: 600;\n      color: #000;\n    }\n    li {\n      float: left;\n      margin-right: 15px;\n      font-size: 14px;\n      color: rgba(0, 0, 0, 0.6);\n      cursor: pointer;\n    }\n    li:hover {\n      color: rgba(0, 0, 0, 0.9);\n    }\n  }\n  .el-button {\n    position: absolute;\n    right: 20px;\n    border-radius: 20px;\n    top: 5px;\n  }\n}\n</style>\n"]}]}
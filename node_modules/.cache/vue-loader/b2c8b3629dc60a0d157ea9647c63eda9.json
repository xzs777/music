{"remainingRequest":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\src\\components\\search\\searchList.vue?vue&type=style&index=0&id=9fbeaa66&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\src\\components\\search\\searchList.vue","mtime":1604995848855},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\74031\\Desktop\\新建文件夹 (4)\\vue_music-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5tYWluLW5hdiB7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKfQoubWFpbi1zb25nLWxpc3QgLm1haW4tcGFnZSB7CiAgd2lkdGg6IDM1MHB4OwogIG1hcmdpbjogMCBhdXRvOwogIGhlaWdodDogNTBweDsKICBwYWRkaW5nOiAxMHB4IDA7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICBtYXJnaW4tYm90dG9tOiAxMHB4Owp9Ci5tYWluLXNvbmctdHQgewogIGhlaWdodDogODBweDsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIGJveC1zaGFkb3c6IDAgMCA0cHggcmdiYSgwLCAwLCAwLCAwLjI1KTsKICBtYXJnaW4tYm90dG9tOiA0cHg7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHBhZGRpbmc6IDIwcHg7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICBzcGFuIHsKICAgIGZvbnQtc2l6ZTogMjBweDsKICB9CiAgaSB7CiAgICBmb250LXNpemU6IDEzcHg7CiAgICBmb250LXN0eWxlOiBub3JtYWw7CiAgICBtYXJnaW4tbGVmdDogMTBweDsKICAgIGNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuNzUpOwogIH0KfQoubWFpbi1zb25nLWxpc3QgewogIGhlaWdodDogNDIwcHg7CiAgb3ZlcmZsb3c6IHNjcm9sbDsKfQouc2VhcmNoLWd1aWRlIHsKICBoZWlnaHQ6IDQ5NHB4OwogIHdpZHRoOiAzNDBweDsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB6LWluZGV4OiA5OTk7CiAgdG9wOiA0MHB4OwogIHJpZ2h0OiAwOwogIGJveC1zaGFkb3c6IC02cHggNnB4IDZweCByZ2JhKDAsIDAsIDAsIDAuMjUpOwogIC5ndWlkZS1ib3ggewogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgIHBhZGRpbmc6IDhweCAxNXB4OwogIH0KICAuZ3VpZGUtYm94LXR0IHsKICAgIGhlaWdodDogNDBweDsKICAgIGxpbmUtaGVpZ2h0OiA0MHB4OwogICAgZm9udC1zaXplOiAxNHB4OwogICAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC42KTsKICB9CiAgLmhvdC10YWdzIC5lbC10YWcgewogICAgYm9yZGVyLXJhZGl1czogMTVweDsKICAgIHBhZGRpbmc6IDAgMTJweDsKICAgIGhlaWdodDogMjZweDsKICAgIGxpbmUtaGVpZ2h0OiAyNnB4OwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgbWFyZ2luLXJpZ2h0OiAxMHB4OwogICAgbWFyZ2luLWJvdHRvbTogOHB4OwogIH0KICAuaG90LXRhZ3MgLmVsLXRhZzpob3ZlciB7CiAgICBiYWNrZ3JvdW5kOiAjZjFmMWYxOwogIH0KfQo="},{"version":3,"sources":["searchList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"searchList.vue","sourceRoot":"src/components/search","sourcesContent":["<template>\n  <div>\n    <div class=\"main-header\">\n      <i class=\"el-icon-arrow-left\" @click=\"$router.push('../music')\"></i>\n      <div class=\"search\">\n        <input\n          type=\"text\"\n          class=\"input-search\"\n          v-model=\"searchValueNew\"\n          @keyup.enter=\"searchEvent\"\n          @focus=\"searchGuide\"\n        />\n        <i class=\"el-icon-search\" @click=\"searchEvent\"></i>\n      </div>\n    </div>\n    <div class=\"search-guide\" v-show=\"searchOpenclose\">\n      <div class=\"guide-box\">\n        <div class=\"guide-box-tt\">热门搜索</div>\n        <div class=\"hot-tags\">\n          <el-tag\n            effect=\"plain\"\n            type=\"info\"\n            v-for=\"(item, i) in searchHots\"\n            :key=\"i\"\n            @click=\"hotTagEvent\"\n          >{{item.first}}</el-tag>\n        </div>\n        <div class=\"guide-box-tt\">历史搜索</div>\n        <div class=\"hot-tags\">\n          <el-tag\n            effect=\"plain\"\n            type=\"info\"\n            v-for=\"(item, i) in historyTags\"\n            :key=\"i\"\n            @click=\"hotTagEvent\"\n            :closable=\"true\"\n            @close=\"historyTagClose(item)\"\n          >{{item}}</el-tag>\n        </div>\n      </div>\n    </div>\n    <div class=\"main-nav\">\n      <div class=\"main-song-tt\">\n        <span>{{searchValue}}</span>\n        <i>找到 {{total}} 首单曲</i>\n      </div>\n      <div class=\"main-song-list\">\n        <el-table :data=\"searchlist\" style=\"width: 100%\" :stripe=\"true\" @row-click=\"getMusicUrl\">\n          <el-table-column type=\"index\" width=\"60px\"></el-table-column>\n          <el-table-column prop=\"name\" label=\"音乐标题\"></el-table-column>\n          <el-table-column prop=\"author\" label=\"歌手\" width=\"180\">\n            <template slot-scope=\"scope\">\n              <span v-for=\"(item,i) in scope.row.author\" :key=\"i\">{{item + ' '}}</span>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"album\" label=\"专辑\" width=\"180\"></el-table-column>\n          <el-table-column prop=\"time\" label=\"时长\" width=\"100\"></el-table-column>\n        </el-table>\n        <div class=\"main-page\">\n          <el-pagination\n            @current-change=\"handleCurrentChange\"\n            :current-page=\"(searchQury.offset/searchQury.limit) + 1\"\n            :page-size=\"searchQury.limit\"\n            layout=\"total, prev, pager, next\"\n            :total=\"total\"\n            background\n            :small=\"true\"\n          ></el-pagination>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      searchQury: {\n        offset: 0,\n        limit: 10,\n        type: 1\n      },\n      searchValue: '',\n      total: 0,\n      searchValueNew: '',\n      searchlist: [],\n      searchOpenclose: false,\n      searchHots: [],\n      historyTags: []\n    }\n  },\n  methods: {\n    // 获取搜索列表\n    async getSearchList(val) {\n      const { data: res } = await this.$request.get(`/search?keywords=${val}`, {\n        params: this.searchQury\n      })\n      const arrData = []\n      res.result.songs.forEach(item => {\n        const arr = {}\n        arr.name = item.name\n        arr.author = []\n        item.artists.forEach(i => {\n          arr.author.push(i.name)\n        })\n        arr.id = item.id\n        arr.album = item.album.name\n        arr.pic = item.artists[0].img1v1Url\n        arr.time =\n          Math.floor((item.duration % 3600000) / 60000) > 10\n            ? Math.floor((item.duration % 3600000) / 60000)\n            : '0' + Math.floor((item.duration % 3600000) / 60000)\n        arr.time +=\n          ':' +\n          (Math.floor((item.duration % 60000) / 1000) > 10\n            ? Math.floor((item.duration % 60000) / 1000)\n            : '0' + Math.floor((item.duration % 60000) / 1000))\n        arrData.push(arr)\n      })\n      this.searchlist = arrData\n      this.total = res.result.songCount\n    },\n    handleCurrentChange(pagenum) {\n      this.searchQury.offset = (pagenum - 1) * this.searchQury.limit\n      this.getSearchList(this.searchValue)\n    },\n    // 获取音乐播放地址\n    async getMusicUrl(obj) {\n      const { data: res } = await this.$request.get(`/song/url?id=${obj.id}`)\n      let music = {}\n      music = {\n        title: obj.name,\n        artist: obj.author.join(' '),\n        src: res.data[0].url,\n        pic: obj.pic,\n        id: obj.id\n      }\n      window.sessionStorage.setItem('nowMusic', JSON.stringify(music))\n      this.$store.dispatch('dealAutoPlay', music)\n    },\n    // 搜索事件\n    searchEvent() {\n      window.sessionStorage.setItem('searchValue', this.searchValueNew)\n      this.searchValue = this.searchValueNew\n      this.getSearchList(this.searchValue)\n      const history = window.sessionStorage.getItem('searchHistory')\n      var arr = history === null ? [] : JSON.parse(history)\n      if (!arr.includes(this.searchValue.trim())) {\n        if (arr.length < 10) {\n          arr.unshift(this.searchValue.trim())\n        } else {\n          arr.splice(9, 1)\n          arr.unshift(this.searchValue.trim())\n        }\n      }\n      window.sessionStorage.setItem('searchHistory', JSON.stringify(arr))\n      this.searchOpenclose = false\n    },\n    // 搜索向导框\n    async searchGuide(el) {\n      this.$store.state.controlMsc.showList = false\n      const { data: res } = await this.$request.get('/search/hot')\n      this.searchHots = res.result.hots\n      const history = window.sessionStorage.getItem('searchHistory')\n      var arr = history === null ? [] : JSON.parse(history)\n      this.historyTags = arr\n      this.searchOpenclose = true\n      const guideBox = document.querySelector('.search-guide')\n      window.onclick = e => {\n        if (!guideBox.contains(e.target) && !el.target.contains(e.target)) {\n          this.searchOpenclose = false\n          window.onclick = null\n        }\n      }\n    },\n    hotTagEvent(e) {\n      this.searchValueNew = e.target.innerText.trim()\n      this.searchEvent()\n    },\n    historyTagClose(tag) {\n      this.historyTags.splice(this.historyTags.indexOf(tag), 1)\n      window.sessionStorage.setItem(\n        'searchHistory',\n        JSON.stringify(this.historyTags)\n      )\n    }\n  },\n  created() {\n    const searchValue = window.sessionStorage.getItem('searchValue')\n    this.searchValue = searchValue.trim()\n    this.getSearchList(searchValue)\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.main-nav {\n  overflow: hidden;\n}\n.main-song-list .main-page {\n  width: 350px;\n  margin: 0 auto;\n  height: 50px;\n  padding: 10px 0;\n  box-sizing: border-box;\n  margin-bottom: 10px;\n}\n.main-song-tt {\n  height: 80px;\n  background: #fff;\n  box-shadow: 0 0 4px rgba(0, 0, 0, 0.25);\n  margin-bottom: 4px;\n  display: flex;\n  align-items: center;\n  padding: 20px;\n  box-sizing: border-box;\n  span {\n    font-size: 20px;\n  }\n  i {\n    font-size: 13px;\n    font-style: normal;\n    margin-left: 10px;\n    color: rgba(0, 0, 0, 0.75);\n  }\n}\n.main-song-list {\n  height: 420px;\n  overflow: scroll;\n}\n.search-guide {\n  height: 494px;\n  width: 340px;\n  background: #fff;\n  position: absolute;\n  z-index: 999;\n  top: 40px;\n  right: 0;\n  box-shadow: -6px 6px 6px rgba(0, 0, 0, 0.25);\n  .guide-box {\n    box-sizing: border-box;\n    padding: 8px 15px;\n  }\n  .guide-box-tt {\n    height: 40px;\n    line-height: 40px;\n    font-size: 14px;\n    color: rgba(0, 0, 0, 0.6);\n  }\n  .hot-tags .el-tag {\n    border-radius: 15px;\n    padding: 0 12px;\n    height: 26px;\n    line-height: 26px;\n    cursor: pointer;\n    margin-right: 10px;\n    margin-bottom: 8px;\n  }\n  .hot-tags .el-tag:hover {\n    background: #f1f1f1;\n  }\n}\n</style>\n"]}]}